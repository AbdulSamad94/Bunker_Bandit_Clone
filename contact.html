<!DOCTYPE html>
<html lang="de">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title data-i18n="contact_title">Kontakt</title>
  <link rel="stylesheet" href="assets/css/default.css" />
  <link rel="stylesheet" href="assets/css/contact.css" />
  <link rel="stylesheet" href="assets/css/language-switcher.css" />
</head>

<body>
  <div id="header"></div>

  <main>
    <form class="contact-form">
      <div class="inputs-div">
        <label data-i18n="name_label">Name</label>
        <input type="text" data-i18n-placeholder="name_placeholder" placeholder="Dein Name" />
      </div>

      <div class="inputs-div">
        <label data-i18n="email_label">E-Mail</label>
        <input type="email" data-i18n-placeholder="email_placeholder" placeholder="deine@email.de" />
      </div>

      <div class="inputs-div">
        <label data-i18n="subject_label">Betreff</label>
        <select name="options">
          <option value="" data-i18n="subject_default">
            Wähle einen Betreff
          </option>
          <option value="Booking Anfrage" data-i18n="subject_booking">
            Booking Anfrage
          </option>
          <option value="Press & Media" data-i18n="subject_press">
            Press & Media
          </option>
          <option value="Fan Mail" data-i18n="subject_fanmail">
            Fan Mail
          </option>
          <option value="Sonstiges" data-i18n="subject_other">
            Sonstiges
          </option>
        </select>
      </div>

      <div class="inputs-div">
        <label data-i18n="message_label">Nachricht</label>
        <textarea data-i18n-placeholder="message_placeholder" placeholder="Deine Nachricht an uns"></textarea>
      </div>

      <button data-i18n="submit_button">Nachricht Senden</button>
    </form>
  </main>

  <footer id="footer"></footer>

  <script src="/assets/scripts/language-switcher.js"></script>
  <script src="assets/scripts/component.js" defer></script>
  <script>
    const form = document.querySelector('.contact-form');

    form.addEventListener('submit', async (e) => {
      e.preventDefault();

      const name = form.querySelector('input[type="text"]').value.trim();
      const email = form.querySelector('input[type="email"]').value.trim();
      const subject = form.querySelector('select').value;
      const message = form.querySelector('textarea').value.trim();

      if (!name || !email || !subject || !message) {
        alert('Bitte fülle alle Felder aus.');
        return;
      }

      try {
        const res = await fetch('api/send-email', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ name, email, subject, message }),
        });

        const data = await res.json();

        if (data.success) {
          alert('Email Sent Succesfully');
          form.reset();
        } else {
          alert('Email Failed to send.');
        }
      } catch (err) {
        alert('Server error.');
      }
    });
  </script>
</body>

</html>